package com.sm.sdk.demo.emv;

import com.sm.sdk.demo.Constant;
import com.sm.sdk.demo.MyApplication;
import com.sm.sdk.demo.utils.ByteUtil;
import com.sm.sdk.demo.utils.LogUtil;
import com.sunmi.pay.hardware.aidlv2.AidlConstantsV2;
import com.sunmi.pay.hardware.aidlv2.bean.AidV2;
import com.sunmi.pay.hardware.aidlv2.bean.CapkV2;
import com.sunmi.pay.hardware.aidlv2.bean.EmvTermParamV2;
import com.sunmi.pay.hardware.aidlv2.emv.EMVOptV2;
import com.sunmi.pay.hardware.aidlv2.security.SecurityOptV2;

import java.util.HashMap;
import java.util.Map;

public final class EmvUtil {
    public static final String COUNTRY_CHINA = "China";
    public static final String COUNTRY_RUSSIA = "Russia";
    public static final String COUNTRY_INDIA = "India";

    private EmvUtil() {
    }

    /**
     * Config country code,capability,transaction currency code,transaction currency code exponent
     * <br/> Client should config their own data according their country.
     */
    public static Map<String, String> getConfig(String country) {
        Map<String, String> map = new HashMap<>();
        switch (country) {
            case COUNTRY_RUSSIA:
                map.put("countryCode", "0643");
                map.put("capability", "E0F8C8");
                map.put("5F2A", "0643");
                map.put("5F36", "00");
                break;
            case COUNTRY_INDIA:
                map.put("countryCode", "0356");
                map.put("capability", "E0F8C8");
                map.put("5F2A", "0356");
                map.put("5F36", "02");
                break;
            case COUNTRY_CHINA:
            default:
                map.put("countryCode", "0156");     // country code(国家代码)
                map.put("capability", "E0F8C8");    // capability(终端性能)
                map.put("5F2A", "0156");            // transaction currency code(交易货币代码)
                map.put("5F36", "00");              // transaction currency code exponent(交易货币代码指数)
        }
        return map;
    }

    /**
     * Initialize keys.
     * <br/>Client App should save their own keys.
     */
    public static void initKey() {
        try {
            SecurityOptV2 mSecurityOptV2 = MyApplication.mSecurityOptV2;

            byte[] cvByte = ByteUtil.hexStr2Bytes("82E13665B4624DF5");

            // save KEK
            byte[] dataByte = ByteUtil.hexStr2Bytes("11111111111111111111111111111111");
            int result = mSecurityOptV2.savePlaintextKey(AidlConstantsV2.Security.KEY_TYPE_KEK, dataByte, cvByte, AidlConstantsV2.Security.KEY_ALG_TYPE_3DES, 10);
            LogUtil.e(Constant.TAG, "save KEK result:" + result);
            if (result != 0) {
                LogUtil.e(Constant.TAG, "save KEK fail");
                return;
            }

            // save TMK
            dataByte = ByteUtil.hexStr2Bytes("F40379AB9E0EC533F40379AB9E0EC533");
            result = mSecurityOptV2.saveCiphertextKey(AidlConstantsV2.Security.KEY_TYPE_TMK, dataByte, cvByte, 10, AidlConstantsV2.Security.KEY_ALG_TYPE_3DES, 11);
            LogUtil.e(Constant.TAG, "save TMK result:" + result);
            if (result != 0) {
                LogUtil.e(Constant.TAG, "save TMK fail");
                return;
            }

            // save PIK
            result = mSecurityOptV2.saveCiphertextKey(AidlConstantsV2.Security.KEY_TYPE_PIK, dataByte, cvByte, 11, AidlConstantsV2.Security.KEY_ALG_TYPE_3DES, 12);
            LogUtil.e(Constant.TAG, "save PIK result:" + result);
            if (result != 0) {
                LogUtil.e(Constant.TAG, "save PIK fail");
                return;
            }

            // save MAK
            result = mSecurityOptV2.saveCiphertextKey(AidlConstantsV2.Security.KEY_TYPE_MAK, dataByte, cvByte, 11, AidlConstantsV2.Security.KEY_ALG_TYPE_3DES, 13);
            LogUtil.e(Constant.TAG, "save MAK result:" + result);
            if (result != 0) {
                LogUtil.e(Constant.TAG, "save MAK fail");
                return;
            }

            // save TDK
            result = mSecurityOptV2.saveCiphertextKey(AidlConstantsV2.Security.KEY_TYPE_TDK, dataByte, cvByte, 11, AidlConstantsV2.Security.KEY_ALG_TYPE_3DES, 14);
            LogUtil.e(Constant.TAG, "save TDK result:" + result);
            if (result != 0) {
                LogUtil.e(Constant.TAG, "save TDK fail");
                return;
            }

            LogUtil.e(Constant.TAG, "init key success");
        } catch (Exception e) {
            e.printStackTrace();
            LogUtil.e(Constant.TAG, "init key fail");
        }
    }

    /**
     * Initialize AIDs and RIDs.
     * <br/>Client App should save their own AIDs and RIDs
     * <br/> Note: The AIDs and RIDs shown in this method may not
     * useful for your App, please save your own AIDs and RIDs at
     * this step.
     * <br/> SDK have several built-in AIDs and Capks, if dont want them,
     * call EMVOptV2.deleteAid(null) or EMVOptV2.deleteCapk(null,null)
     * firstly.
     */
    public static void initAidAndRid() {
        try {
            EMVOptV2 emvOptV2 = MyApplication.mEMVOptV2;
//            emvOptV2.deleteAid(null);//clear SDK built-in AIDs
            // clear SDK built-in AIDs and CAPKs
            emvOptV2.deleteAid(null);
            emvOptV2.deleteCapk(null, null);
            // Normal AIDs
            AidV2 aid = EmvUtil.hexStr2Aid("9F0608A000000333010101DF0101009F08020020DF1105D84000A800DF1205D84004F800DF130500100000009F1B040000C350DF150400000000DF160199DF170199DF14039F3704DF1801019F7B06100000000000DF1906100000000000DF2006100000000000DF21061000000000005F2A020643");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A000000333010102DF0101009F08020020DF1105D84000A800DF1205D84004F800DF130500100000009F1B040000C350DF150400000000DF160199DF170199DF14039F3704DF1801019F7B06100000000000DF1906100000000000DF2006100000000000DF21061000000000005F2A020643");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A000000333010103DF0101009F08020020DF1105D84000A800DF1205D84004F800DF130500100000009F1B040000C350DF150400000000DF160199DF170199DF14039F3704DF1801019F7B06100000000000DF1906100000000000DF2006100000000000DF21061000000000005F2A020643");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A000000333010106DF0101009F08020020DF1105D84000A800DF1205D84004F800DF130500100000009F1B040000C350DF150400000000DF160199DF170199DF14039F3704DF1801019F7B06100000000000DF1906100000000000DF2006100000000000DF21061000000000005F2A020643");
            emvOptV2.addAid(aid);
            // Russia AIDs
            aid = EmvUtil.hexStr2Aid("9F0607A00000000410109F09020000DF11050000000000DF12050000000000DF130500000000009F1B0400000000DF150400000000DF160100DF170100DF140b9F37049F47018F019F32019F3C0206439F3D0102DF1906000000000000DF2006999999999999DF21060000000030009F4E009F150211119F160c746573746D65726368616E74");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0607A00000000310109F09020000DF11050000000000DF12050000000000DF130500000000009F1B0400000000DF150400000000DF160100DF170100DF14039F37049F3C0206439F3D0102DF1906000000000000DF2006999999999999DF21060000000000009F4E009F150211119F160c746573746D65726368616E74");
            emvOptV2.addAid(aid);
            // India AIDs
            aid = EmvUtil.hexStr2Aid("9F0607A00000052410109F09020064DF1105FFFFFFFFFFDF1205FFFFFFFFFFDF130500000000009F1B0400000000DF150400000000DF160100DF170100DF14039F37049F3C0203569F3D0102DF1906000000000000DF2006999999999999DF21060000000030009F4E009F15009F1600");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0607A00000015230109F09020001DF1105FFFFFFFFFFDF1205FFFFFFFFFFDF130500000000009F1B0400000000DF150400000000DF160100DF170100DF14039F37049F3C0203569F3D0102DF1906000000000000DF2006999999999999DF21060000000000009F4E009F15009F1600");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0607A00000006510109F09020200DF1105FFFFFFFFFFDF1205FFFFFFFFFFDF130500000000009F1B0400000000DF150400000000DF160100DF170100DF14039F37049F3C0203569F3D0102DF1906000000000000DF2006999999999999DF21060000000000009F4E009F15009F1600");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A0000003330101019F09020200DF1105FFFFFFFFFFDF1205FFFFFFFFFFDF130500000000009F1B0400000000DF150400000000DF160100DF170100DF14039F37049F3C0203569F3D0102DF1906000000000000DF2006999999999999DF21060000000000009F4E009F15009F1600");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A0000003330101029F09020200DF1105FFFFFFFFFFDF1205FFFFFFFFFFDF130500000000009F1B0400000000DF150400000000DF160100DF170100DF14039F37049F3C0203569F3D0102DF1906000000000000DF2006999999999999DF21060000000000009F4E009F15009F1600");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A0000003330101039F09020200DF1105FFFFFFFFFFDF1205FFFFFFFFFFDF130500000000009F1B0400000000DF150400000000DF160100DF170100DF14039F37049F3C0203569F3D0102DF1906000000000000DF2006999999999999DF21060000000000009F4E009F15009F1600");
            emvOptV2.addAid(aid);
            //AE
            aid = EmvUtil.hexStr2Aid("9F0606A00000002501DF010100DF11050000000000DF12050000000000DF12050000000000DF14039F3704DF150400000000DF160199DF1701009F1B04000027109F090200019F150241129F16063132333435369F4E105261696C776179204F70657261746F729F1C063030303030309F1D0200019F3C020000DF81010200009F3D0102DF8102039F37049F7B060000000100009F01051234567890DF1906000000010000DF2006000000015000DF2106000000005000");
            emvOptV2.addAid(aid);

            //添加 MCCS的AID
            aid = hexStr2Aid("9F01060111111111119F0607A00000061500019F090200019F150211119F160c746573746D65726368616E749F1B04000000009F3C0206439F3D01029F4E009F7B06000000000000DF010100DF1105F45084800CDF1205F45084800CDF13050000000000DF14039F3704DF150400000000DF160100DF170100DF1906000000000000DF2006999999999999DF2106000000025001");
            emvOptV2.addAid(aid);

            // Normal RIDs
            CapkV2 capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220104DF05083230323531323331DF060101DF070101DF0281F8BC853E6B5365E89E7EE9317C94B02D0ABB0DBD91C05A224A2554AA29ED9FCB9D86EB9CCBB322A57811F86188AAC7351C72BD9EF196C5A01ACEF7A4EB0D2AD63D9E6AC2E7836547CB1595C68BCBAFD0F6728760F3A7CA7B97301B7E0220184EFC4F653008D93CE098C0D93B45201096D1ADFF4CF1F9FC02AF759DA27CD6DFD6D789B099F16F378B6100334E63F3D35F3251A5EC78693731F5233519CDB380F5AB8C0F02728E91D469ABD0EAE0D93B1CC66CE127B29C7D77441A49D09FCA5D6D9762FC74C31BB506C8BAE3C79AD6C2578775B95956B5370D1D0519E37906B384736233251E8F09AD79DFBE2C6ABFADAC8E4D8624318C27DAF1DF040103DF0314F527081CF371DD7E1FD4FA414A665036E0F5E6E5");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220103DF05083230323431323331DF060101DF070101DF0281B0B0627DEE87864F9C18C13B9A1F025448BF13C58380C91F4CEBA9F9BCB214FF8414E9B59D6ABA10F941C7331768F47B2127907D857FA39AAF8CE02045DD01619D689EE731C551159BE7EB2D51A372FF56B556E5CB2FDE36E23073A44CA215D6C26CA68847B388E39520E0026E62294B557D6470440CA0AEFC9438C923AEC9B2098D6D3A1AF5E8B1DE36F4B53040109D89B77CAFAF70C26C601ABDF59EEC0FDC8A99089140CD2E817E335175B03B7AA33DDF040103DF031487F0CD7C0E86F38F89A66F8C47071A8B88586F26");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220102DF05083230323131323331DF060101DF070101DF028190A3767ABD1B6AA69D7F3FBF28C092DE9ED1E658BA5F0909AF7A1CCD907373B7210FDEB16287BA8E78E1529F443976FD27F991EC67D95E5F4E96B127CAB2396A94D6E45CDA44CA4C4867570D6B07542F8D4BF9FF97975DB9891515E66F525D2B3CBEB6D662BFB6C3F338E93B02142BFC44173A3764C56AADD202075B26DC2F9F7D7AE74BD7D00FD05EE430032663D27A57DF040103DF031403BB335A8549A03B87AB089D006F60852E4B8060");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220101DF05083230313431323331DF060101DF070101DF028180BBE9066D2517511D239C7BFA77884144AE20C7372F515147E8CE6537C54C0A6A4D45F8CA4D290870CDA59F1344EF71D17D3F35D92F3F06778D0D511EC2A7DC4FFEADF4FB1253CE37A7B2B5A3741227BEF72524DA7A2B7B1CB426BEE27BC513B0CB11AB99BC1BC61DF5AC6CC4D831D0848788CD74F6D543AD37C5A2B4C5D5A93BDF040103DF0314E881E390675D44C2DD81234DCE29C3F5AB2297A0");
            emvOptV2.addCapk(capkV2);
            // Russia RIDs
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201FADF0503202001DF060101DF070101DF028190A90FCD55AA2D5D9963E35ED0F440177699832F49C6BAB15CDAE5794BE93F934D4462D5D12762E48C38BA83D8445DEAA74195A301A102B2F114EADA0D180EE5E7A5C73E0C4E11F67A43DDAB5D55683B1474CC0627F44B8D3088A492FFAADAD4F42422D0E7013536C3C49AD3D0FAE96459B0F6B1B6056538A3D6D44640F94467B108867DEC40FAAECD740C00E2B7A8852DDF040103DF03145BED4068D96EA16D2D77E03D6036FC7A160EA99C");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201F1DF0503202001DF060101DF070101DF0281b0A0DCF4BDE19C3546B4B6F0414D174DDE294AABBB828C5A834D73AAE27C99B0B053A90278007239B6459FF0BBCD7B4B9C6C50AC02CE91368DA1BD21AAEADBC65347337D89B68F5C99A09D05BE02DD1F8C5BA20E2F13FB2A27C41D3F85CAD5CF6668E75851EC66EDBF98851FD4E42C44C1D59F5984703B27D5B9F21B8FA0D93279FBBF69E090642909C9EA27F898959541AA6757F5F624104F6E1D3A9532F2A6E51515AEAD1B43B3D7835088A2FAFA7BE7DF040103DF0314D8E68DA167AB5A85D8C3D55ECB9B0517A1A5B4BB");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201EFDF0503202001DF060101DF070101DF0281f8A191CB87473F29349B5D60A88B3EAEE0973AA6F1A082F358D849FDDFF9C091F899EDA9792CAF09EF28F5D22404B88A2293EEBBC1949C43BEA4D60CFD879A1539544E09E0F09F60F065B2BF2A13ECC705F3D468B9D33AE77AD9D3F19CA40F23DCF5EB7C04DC8F69EBA565B1EBCB4686CD274785530FF6F6E9EE43AA43FDB02CE00DAEC15C7B8FD6A9B394BABA419D3F6DC85E16569BE8E76989688EFEA2DF22FF7D35C043338DEAA982A02B866DE5328519EBBCD6F03CDD686673847F84DB651AB86C28CF1462562C577B853564A290C8556D818531268D25CC98A4CC6A0BDFFFDA2DCCA3A94C998559E307FDDF915006D9A987B07DDAEB3BDF040103DF031421766EBB0EE122AFB65D7845B73DB46BAB65427A");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F220147DF0503202001DF060101DF070101DF028190F562B594C911C0310AEFB002BDFE01CC8C2F1351CAEDD12C5210F4C3507BC106E01BBF94362392F3A66496079CBC8EAD09D5D942B195CA12A8A1AABAEF1D5545AF1693484764DEB625100E15F630510F3E2FB9E00D81F86D4C6F099307182E30F67FBE9C3D91F557BA5AAA1ACFBB625ABFA0176D4CEF3DFE1892BA1EC49F57B5DB6C53147F1DC9FD844298E238A94FEBDF040103DF03146304B43BAF1342F914ABD4B55EE817CEF1FA557F");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201F5DF0503202001DF060101DF070101DF0281f8A6E6FB72179506F860CCCA8C27F99CECD94C7D4F3191D303BBEE37481C7AA15F233BA755E9E4376345A9A67E7994BDC1C680BB3522D8C93EB0CCC91AD31AD450DA30D337662D19AC03E2B4EF5F6EC18282D491E19767D7B24542DFDEFF6F62185503532069BBB369E3BB9FB19AC6F1C30B97D249EEE764E0BAC97F25C873D973953E5153A42064BBFABFD06A4BB486860BF6637406C9FC36813A4A75F75C31CCA9F69F8DE59ADECEF6BDE7E07800FCBE035D3176AF8473E23E9AA3DFEE221196D1148302677C720CFE2544A03DB553E7F1B8427BA1CC72B0F29B12DFEF4C081D076D353E71880AADFF386352AF0AB7B28ED49E1E672D11F9DF0403010001DF0314C2239804C8098170BE52D6D5D4159E81CE8466BF");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201F7DF0503202001DF060101DF070101DF0281f8B8C5759F96676BEF1FE2DE8AAD8C54B08E919FD1B8C516D70931435E41A306A64A5F73E4542B46BFBDC8EB32E973737406C0DE7AF80FDE023B5F256EF4D120EEB537171D1ADA4D83C307961AF8DB13B63828EE2EE036FAF2C41D5EE250ED2A4AF317511411EDD39CD52F2A10CA17F4FE652FD7E79BC031C36AD26DFB54CFC562551793B04A47ED1A21E96D2E4CA29EB9A4FE6524E6CF69DE5CA5C0BEDFA624AE6BC78FEFE3993564D59B67DED46455040FB3BFD2B6447D111C83C0E29C72C00142BAB87EBCFC54BE58EAEE78292B05F358175DC67F3916CCB08907A41EF0785DAA4D21B279B9A386AB7F6624B2144E3E35C1BF29954B2D7BDF040103DF031486803714DF3BDE4C19F62E1FF01CE96D3C1D1706");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F220105DF0503202001DF060101DF070101DF0281b0B8048ABC30C90D976336543E3FD7091C8FE4800DF820ED55E7E94813ED00555B573FECA3D84AF6131A651D66CFF4284FB13B635EDD0EE40176D8BF04B7FD1C7BACF9AC7327DFAA8AA72D10DB3B8E70B2DDD811CB4196525EA386ACC33C0D9D4575916469C4E4F53E8E1C912CC618CB22DDE7C3568E90022E6BBA770202E4522A2DD623D180E215BD1D1507FE3DC90CA310D27B3EFCCD8F83DE3052CAD1E48938C68D095AAC91B5F37E28BB49EC7ED597DF040103DF0314EBFA0D5D06D8CE702DA3EAE890701D45E274C845");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220195DF0503202001DF060101DF070101DF028190BE9E1FA5E9A803852999C4AB432DB28600DCD9DAB76DFAAA47355A0FE37B1508AC6BF38860D3C6C2E5B12A3CAAF2A7005A7241EBAA7771112C74CF9A0634652FBCA0E5980C54A64761EA101A114E0F0B5572ADD57D010B7C9C887E104CA4EE1272DA66D997B9A90B5A6D624AB6C57E73C8F919000EB5F684898EF8C3DBEFB330C62660BED88EA78E909AFF05F6DA627BDF040103DF0314EE1511CEC71020A9B90443B37B1D5F6E703030F6");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220199DF0503202001DF060101DF070101DF028180AB79FCC9520896967E776E64444E5DCDD6E13611874F3985722520425295EEA4BD0C2781DE7F31CD3D041F565F747306EED62954B17EDABA3A6C5B85A1DE1BEB9A34141AF38FCF8279C9DEA0D5A6710D08DB4124F041945587E20359BAB47B7575AD94262D4B25F264AF33DEDCF28E09615E937DE32EDC03C54445FE7E382777DF040103DF03144ABFFD6B1C51212D05552E431C5B17007D2F5E6D");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220150DF0503202001DF060101DF070101DF028180D11197590057B84196C2F4D11A8F3C05408F422A35D702F90106EA5B019BB28AE607AA9CDEBCD0D81A38D48C7EBB0062D287369EC0C42124246AC30D80CD602AB7238D51084DED4698162C59D25EAC1E66255B4DB2352526EF0982C3B8AD3D1CCE85B01DB5788E75E09F44BE7361366DEF9D1E1317B05E5D0FF5290F88A0DB47DF040103DF03145765295089960938BAAA4431506E424295F98BD0");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220192DF0503202001DF060101DF070101DF0281b0996AF56F569187D09293C14810450ED8EE3357397B18A2458EFAA92DA3B6DF6514EC060195318FD43BE9B8F0CC669E3F844057CBDDF8BDA191BB64473BC8DC9A730DB8F6B4EDE3924186FFD9B8C7735789C23A36BA0B8AF65372EB57EA5D89E7D14E9C7B6B557460F10885DA16AC923F15AF3758F0F03EBD3C5C2C949CBA306DB44E6A2C076C5F67E281D7EF56785DC4D75945E491F01918800A9E2DC66F60080566CE0DAF8D17EAD46AD8E30A247C9FDF040103DF0314429C954A3859CEF91295F663C963E582ED6EB253");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220194DF0503202001DF060101DF070101DF0281f8ACD2B12302EE644F3F835ABD1FC7A6F62CCE48FFEC622AA8EF062BEF6FB8BA8BC68BBF6AB5870EED579BC3973E121303D34841A796D6DCBC41DBF9E52C4609795C0CCF7EE86FA1D5CB041071ED2C51D2202F63F1156C58A92D38BC60BDF424E1776E2BC9648078A03B36FB554375FC53D57C73F5160EA59F3AFC5398EC7B67758D65C9BFF7828B6B82D4BE124A416AB7301914311EA462C19F771F31B3B57336000DFF732D3B83DE07052D730354D297BEC72871DCCF0E193F171ABA27EE464C6A97690943D59BDABB2A27EB71CEEBDAFA1176046478FD62FEC452D5CA393296530AA3F41927ADFE434A2DF2AE3054F8840657A26E0FC617DF040103DF0314C4A3C43CCF87327D136B804160E47D43B60E6E0F");
            emvOptV2.addCapk(capkV2);
            // India RIDs
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000005249F22016BDF028190C9DFDB625ADA4B5E86049F85A0237627B59524F52BD499B4C5482C1EE012D61A1446E9383CC0B7EE2922D323A5ECDA12941EA8177CFA512DA6B5B7663A89B793B10D314CBB776EB96D0B1734EDE7E1591713915E9991B7B4E8A017A6901279AEBDD6136C9FE7E0C6CBF94C77FA606B629D00B1F890473905EB4DAD1AD93B29C2C1829A82F880B08986B9387611EE409DDF040103DF060101DF070101DF03149602428A46271C63CCC6DD99477CDB70435D6D5BDF0503201231");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000005249F22016ADF02818092795EAA4FE39EB30441FE952D5423778E02F86783B89DD7C587AE80A69F4D6DC55EAFB6604040D875C72002425EE529CE4EA26FD864BAD760160C2AA0C5AF92381894A5CBBC8AB3AF2641606C379B927A397CB1E9B9EA2EF8C0A9C0DDEBB81B0F8913A118F7044156EA7D23AF626EAF30C2C9ECE8534D3563EF5FE95DE76249DF040103DF060101DF070101DF031451ED4570323CD41A0348BDFEA81CCC0B8D9BAB3FDF0503201231");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000005249F22016CDF0281b0C76259FF785ABD5FF613223C01F5BDA0F36F9342CF336B66C32D4B2CD5096E094D8E04DFA11A9B2E3BC78DA63B5C10148D8ED79EBA685D5D0EFE1C58B3F929D861B40FF3AAA3B527148D0C24921EE42DA048E01E38F6A3A49DFA67DD1CD5DD2091412DD36D3269FAF7D2E0FFB1A3E028969CB6BA5A9303A6FF65540F421B069A31B553398EE525EFA5C2CE26BCB81C5345018D5E3E9B7130F72F598C0EAA4682D4DA2F2204518780A8108F82DDC9CF1FDF040103DF060101DF070101DF03143B18A21BF34F781208145D7567982513D1CE8C92DF0503201231");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000005249F22016DDF0281f8B747E8CB3615E8D26231355488F3C76C4746F7BB1C381E6C6E6ABF0A6D7CD93CFC6B2C310288CA8BE7EE1730DE621A59D1BB2D8C02C9148FA06E5D1F5E672EEFCE8AECBAD4A1C18F3175F1BEA1AEF539376592366B46A5044E32E59B3F35F50E85F843BA01851E5386B7EBE27367D3D483C5472D3020AF42116DDDA32341557EBABB043EBC6006B99A652009045BFA50C527028586E05942E1D594223B49FE8566931C31FBE8C903ABD4F283E1FAB03D758247EC4B728A85A9897601B753293263ADBD10BE988D0C52FE0091C2721DC02C5130FC7663E95739A70EE2F84DFD2E50C88A1A26587EF7CC047FCA2D03C2CF0CE4B524B4EC3F07DF040103DF060101DF070101DF0314411008F9921B89C62E2160F6D0358614115ECD4ADF0503201231");
            emvOptV2.addCapk(capkV2);
            //AE Capk
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000259F220197DF028190E178FFE834B4B767AF3C9A511F973D8E8505C5FCB2D3768075AB7CC946A955789955879AAF737407151521996DFA43C58E6B130EB1D863B85DC9FFB4050947A2676AA6A061A4A7AE1EDB0E36A697E87E037517EB8923136875BA2CA1087CBA7EC7653E5E28A0C261A033AF27E3A67B64BBA26956307EC47E674E3F8B722B3AE0498DB16C7985310D9F3D117300D32B09DF0314EBDA522B631B3EB4F4CBFC0679C450139D2B69CDDF040103DF060100DF070101DF050420481231");
            emvOptV2.addCapk(capkV2);
            LogUtil.e(Constant.TAG, "init AID and CAPKs success");
        } catch (Exception e) {
            e.printStackTrace();
            LogUtil.e(Constant.TAG, "initAIDAndRid fail");
        }
    }

    /**
     * Initialize NFC-Speedup aid and rid
     */
    public static void initNFCSpeedupAidAndRid() {
        try {
            EMVOptV2 emvOptV2 = MyApplication.mEMVOptV2;
            // clea Aid and Capk
            emvOptV2.deleteAid(null);
            emvOptV2.deleteCapk(null, null);

            //BCTC AIDs
            AidV2 aid = EmvUtil.hexStr2Aid("9F0607A0000003330101DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000027109F090200309F150212349F160F3030303030303030303030303030309F4E085465726D696E616C9F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000020000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0610A0000003330101010203040506070809DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000027109F090200309F150212349F160F3030303030303030303030303030309F4E085465726D696E616C9F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A000000333010102DF010101DF11050020000000DF12050020000000DF13050020000000DF14039F3704DF150400000000DF160100DF1701009F1B04000027109F090200309F150212349F160F3030303030303030303030303030309F4E085465726D696E616C9F1C084261636B393631329F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0607A0000000031010DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000150009F090200969F150212349F160F3030303030303030303030303030309F4E0653484F5020319F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F01060123456789109F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A000000003101003DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000150009F090200969F150212349F160F3030303030303030303030303030309F4E0653484F5020319F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A000000003101004DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000027109F090200969F150212349F160F3030303030303030303030303030309F4E085465726D696E616C9F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A000000003101005DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000027109F090200969F150212349F160F3030303030303030303030303030309F4E085465726D696E616C9F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A000000003101006DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000027109F090200969F150212349F160F3030303030303030303030303030309F4E085465726D696E616C9F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0608A000000003101007DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000027109F090200969F150212349F160F3030303030303030303030303030309F4E085465726D696E616C9F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0607A0000000999090DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000027109F090200099F150212349F160F3030303030303030303030303030309F4E085465726D696E616C9F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0606A00000999901DF010101DF11050000000000DF12050000000000DF13050000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000027109F090299999F150212349F160F3030303030303030303030303030309F4E085465726D696E616C9F1C0846726F6E743132339F1D01015F3601029F3C020840DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);
            aid = EmvUtil.hexStr2Aid("9F0607A0000000041010DF010101DF11050000000000DF12050000000000DF13054000000000DF14039F3704DF150400000000DF160100DF1701009F1B04000200009F090200029F150213429F160F3030303030303030303030303030309F4E0653484F5020329F1C084261636B313233349F1D01015F3601039F3C020056DF81010208409F3D0102DF8102039F37045F2A0208409F010512345678919F7B06000000010000DF1906000000015000DF2006000000020000DF2106000000010000DFC1080101");
            emvOptV2.addAid(aid);

            // BCTC RIDs
            CapkV2 capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220180DF0803000000DF050420201231DF060101DF070100DF028180CCDBA686E2EFB84CE2EA01209EEB53BEF21AB6D353274FF8391D7035D76E2156CAEDD07510E07DAFCACABB7CCB0950BA2F0A3CEC313C52EE6CD09EF00401A3D6CC5F68CA5FCD0AC6132141FAFD1CFA36A2692D02DDC27EDA4CD5BEA6FF21913B513CE78BF33E6877AA5B605BC69A534F3777CBED6376BA649C72516A7E16AF85DF0403010001DF031498B7628CC6111866270DB8F941B234238959EFEF");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220105DF0803000000DF050420201231DF060101DF070100DF0281F897CF8BAD30CAE0F9A89285454DDDE967AAFBCD4BC0B78F29ECB1005286F15F6D7532A9C476607C73FF7424316DFC741894AA52EDBAF909719C7B53448343B45CF2F00A8ABFB78CEEBE848933AAED97DBE84F0730F34FB1AA1528D3D6EC75B73252A30D0C717518BE36458ADD0FBF854C65497F3F54084154B60F51561361EE8E85F742A54005524CB00FEBC334276E0E63DAD86C079A9A3DF5DD32BECADE1AB2B71F5F0A0E95A4000D01F1044A578AAD92E9FDE92E3C6AA3DCD4913DFA5552537E7DE75E241FAED455D76CB8FCAFEED3FD6DAB24D7A9C32852F866C751D7710F494A0DF11B67FAECDD87A9A4E2CC44F6F27E46E3C0CCCD0FDF040103DF0314852123384D643A0FB10500AA4462C14EC16A87E7");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("f9F0605A0000003339F220157DF0803000000DF050420201231DF060104DF070101DF0240E8105E77861FD2EB727C84E36D3D4A5666BD0ADCE8781F0145D3D82D72B92748E22D5404C6C41F3EC8B790DE2F61CF29FAECB168C79F5C8666762D53CC26A460DF040101DF0314E3A795C1AC809B0AAFE1157C4C44366454AA0750");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("f9F0605A0000003339F220158DF0803000000DF050420201231DF060104DF070101DF0240FFC2B1513320C275411DBADD2188203F7B62519F8C7BA98EF8AA9FD6D2E475984E383C3E12784B42B066960EEA0C8FC8099E14128055D67A666CCA5A058C26A4DF040101DF03146A51EE242553FDD4F1E5C5FB958DFAB156B98FB3");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220157DF0803000000DF050420201231DF060101DF070100DF0260942B7F2BA5EA307312B63DF77C5243618ACC2002BD7ECB74D821FE7BDC78BF28F49F74190AD9B23B9713B140FFEC1FB429D93F56BDC7ADE4AC075D75532C1E590B21874C7952F29B8C0F0C1CE3AEEDC8DA25343123E71DCF86C6998E15F756E3DF0403010001DF0314FC215F38BDCF12CC8E3B608E4058F4E4A58D4927");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F2201C0DF0803000000DF050420201231DF060101DF070100DF028190C7CDB6F2A3FE80A8834CDDDD326E1082AA2288F47C464D57B34718193431711A44119148055044CFE3313708BED0C98E1C589B0F53CF6D7E829FCD906D21A90FD4CB6BAF13110C4685107C27E00981DB29DC0AC186E6D701577F23865626244E1F9B2CD1DDFCB9E899B41F5084D8CCC178A7C3F4546CF93187106FAB055A7AC67DF62E778CB88823BA58CF7546C2B09FDF0403010001DF0314673AEF0889514D24856E066080AFC45BE1C65E64");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F2201C1DF0803000000DF050420201231DF060101DF070100DF0281F892F083CBE46F8DCC0C04E498BA9952BA9D4C09C80DD277E579F07E45772846FA43DD3AB31CC6B08DD18695715949FB108E53A071D393A7FDDBF9C5FB0B0507138797317480FC48D633ED38B401A451443AD7F15FACDA45A62ABE24FF6343ADD0909EA8389348E54E26F842880D1A69F9214368BA30C18DE5C5E0CB9253B5ABC55FB6EF0A738D927494A30BBF82E340285363B6FAA15673829DBB210E710DA58EE9E578E7CE55DC812AB7D6DCCE0E3B1AE179D664F3356EB951E3C91A1CBBF6A7CA8D0C7EC9C6AF7A4941C5051099B9784E56C9162067B8C3B15C5FA4480A645CD2526A69C80BA8EF361BE2AA9417DEFCE35B62B0C9CF097DDF0403010001DF0314C024AF20769619E55E5FD4A0E445068BEE061988");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220161DF0803000000DF050420201231DF060101DF070100DF028180834D2A387C5A5F176EF3E66CAAF83F194B15AAD2470C78C77D6EB38EDAE3A2F9BA1623F6A58C892CC925632DFF48CE954B21A53E1F1E4366BE403C279B90027CBC72605DB6C79049B8992CB4912EFA270BECAB3A7CEFE05BFA46E4C7BBCF7C7A173BD988D989B32CB79FAC8E35FBE1860E7EA9F238A92A3593552D03D1E38601DF040103DF0314008C4830309F455E0FF9EB406EF5F1FE92BFAB5E");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220162DF0803000000DF050420201231DF060101DF070100DF028180B5CDD1E5368819FC3EA65B80C68117BBC29F9096EBD217269B583B0745E0C16433D54B8EF387B1E6CDDAED4923C39E370E5CADFE041773023A6BC0A033B0031B0048F18AC159773CB6695EE99F551F414883FB05E52640E893F4816082241D7BFA3640960003AD7517895C50E184AA956367B7BFFC6D8616A7B57E2D447AB3E1DF0403010001DF031427DD170AE3B3CA6FFF3D8B70FAF861E278821680");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220163DF0803000000DF050420201231DF060101DF070100DF028190867ECA26A57472DEFB6CA94289312BA39C63052518DC480B6ED491ACC37C028846F4D7B79AFAEEFA07FB011DAA46C06021E932D501BF52F2834ADE3AC7689E94B248B28F3FE2803669DEDA000988DA1249F9A891558A05A1E5A7BD2C282FE18D204189A9994D4ADD86C0CE50952ED8BCEC0CE633679188285E51E1BED840FCBFC10953939AF49DB90048912E48B44181DF040103DF031403D2F503802D2F0FFBCC6FC5A188BCC3920601A4");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220164DF0803000000DF050420201231DF060101DF070100DF0281A091123ECF0230E3CB245C88DDFA3EE57BC58ED00B367B3875FCB79548872680F601E8C839AC0721BAB3B89ED21607281C8919BF726266EAB848502AD874B5107A4E654EF6D37773343F461435C86E4A8F866FB18C7CBA497B426290C38D196E2AFF33C0906F9296F297E156DC602A5E653CA1168F1109261114BF7BE8127A3E8007191830134299395CE2B322228667B76E072EB7FD5D0FB3A83E8AD1D7F6FD81DF040103DF03147ADC11ED326AB9D2B758C3EC753EB0FAFA680AA7");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220165DF0803000000DF050420201231DF060101DF070100DF0281B081BA1E6B9F671CFC848CA2ACD8E17AF406B4D329D1ECA5D01BC094A87C30AF49867944C632E8185074655FA535AD8CA42A83B41AAAEA859F432FA0B818E72DC07ED3F77FB318A475A261C0760A156E5DDC157AE8B79BA72D89D69FFF754619E928F1516A2A72C0F86B09B8EA25F86DC5A48EBC5A16F83FBA8FC4E3A98278912249F4E079BCBC06E7BED9AED397879D279ED91925394901260949BCCE6FA1169798A2715DAE32988BEFBE9621AE15E0C1DF0403010001DF03145D3B1D475575F920A3CCAC9BB5B9B57AC5B7F335");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220166DF0803000000DF050420201231DF060101DF070100DF02607F5A3945794D6B15F5F26B4A21A63A5EF35540D8C8C099151F2279780A5C18A317703C98632E804D25576A7B460C05061E03975E50FBD7495B3ADC8E425E53DF76FA40B035E87F69ABF8765A52523F3B1A39B19528B002239015FADBA5921051DF0403010001DF03143D22F31392CFE70D21B0C6729CCCACBA9288181A");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000003339F220168DF0803000000DF050420201231DF060101DF070100DF0281F883B7D2D657DD591370341651E13A893E28680A958F41462A2E358B0DBDD2FD0E6E6F006C857C2EFBC25362CD77D72AAA01F87F66A131ED95546B8AA422CBA017C0875C2BA83A755F5861921D276587080AD46A81AF08B1148DC9EA10AB06B0B6619D29063D048F9A01F4F835998D0B8C3C500578A6599C63CAADB7160CBFE68D6C16ABBF0C02B44781A83FDB19B6755E84C478181F41B81C8826E711687965DFF7CBC433A3229B53AD35C1222313CEBEC22B9E76AB249A99A088C8F3D7E726A7C5A0C921BE6C05A76DF641A1E707A6A195F56D6C9DA311B181618ED93354BF19717CF8D06FA4B4F1F29BC5BD145AEA43824AEA8C46E2E5D1DF0403010001DF0314B5BC6B91C3FAAADD1C49087536F102548CA88F7B");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000099999F2201E1DF0803000000DF050420201231DF060101DF070100DF027099C5B70AA61B4F4C51B6F90B0E3BFB7A3EE0E7DB41BC466888B3EC8E9977C762407EF1D79E0AFB2823100A020C3E8020593DB50E90DBEAC18B78D13F96BB2F57EEDDC30F256592417CDF739CA6804A10A29D2806E774BFA751F22CF3B65B38F37F91B4DAF8AEC9B803F7610E06AC9E6BDF040103DF03142953215B820734A737A812C12F9B9C0D85B288C7");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000099999F2201E2DF0803000000DF050420201231DF060101DF070100DF0270BD232E348B118EB3F6446EF4DA6C3BAC9B2AE510C5AD107D38343255D21C4BDF4952A42E92C633B1CE4BFEC39AFB6DFE147ECBB91D681DAC15FB0E198E9A7E4636BDCA107BCDA3384FCB28B06AFEF90F099E7084511F3CC010D4343503E1E5A67264B4367DAA9A3949499272E9B5022FDF040103DF03141844877C9253299BC59CCA14D8D79EEEE0E0DCFA");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000099999F2201E3DF0803000000DF050420201231DF060101DF070100DF0270BC01E12223E1A41E88BFFA801093C5F8CEC5CD05DBBDBB787CE87249E8808327C2D218991F97A1131E8A25B0122ED11E709C533E8886A1259ADDFDCBB396604D24E505A2D0B5DD0384FB0002A7A1EB39BC8A11339C7A9433A948337761BE73BC497B8E58736DA4636538AD282D3CD3DBDF0403010001DF0314F6014F477B55494C6293391DAE226D9399C8ABED");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000099999F2201E4DF0803000000DF050420201231DF060101DF070100DF028180CBF2E40F0836C9A5E390A37BE3B809BDF5D740CB1DA38CFC05D5F8D6B7745B5E9A3FA6961E55FF20412108525E66B970F902F7FF4305DD832CD0763E3AA8B8173F84777100B1047BD1D744509312A0932ED25FED52A959430768CCD902FD8C8AD9123E6ADDB3F34B92E7924D729CB6473533AE2B2B55BF0E44964FDEA8440117DF040103DF0314EC8C17C8164CA0947B76B37B0EF1C937ADF32E83");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000099999F2201E5DF0803000000DF050420201231DF060101DF070100DF028180D4FDAE94DEDBECC6D20D38B01E91826DC6954338379917B2BB8A6B36B5D3B0C5EDA60B337448BAFFEBCC3ABDBA869E8DADEC6C870110C42F5AAB90A18F4F867F72E3386FFC7E67E7FF94EBA079E531B3CF329517E81C5DD9B3DC65DB5F9043190BE0BE897E5FE48ADF5D3BFA0585E076E554F26EC69814797F15669F4A255C13DF040103DF031412322FD73D5A5933C08A4B28A617FB689B121D58");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000099999F2201E6DF0803000000DF050420201231DF060101DF070100DF028180EBF9FAECC3E5C315709694664775D3FBDA5A504D89344DD920C55696E891D9AB622598A9D6AB8FBF35E4599CAB7EB22F956992F8AB2E6535DECB6B576FA0675F97C23DD4C374A66E6AF419C9D204D0B9F93C08D789D63805660FBB629DF1B488CFA1D7A13E9B729437EEAFE718EFA859348BA0D76812A99F31CD364F2A4FD42FDF0403010001DF0314ED85361CBB8E2109C8F9BB4F559D37844325CD9E");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201FEDF0803000000DF050420201231DF060101DF070100DF028190E76317965175A08BEE510F58830E87B262C70D529803245FA8B88E0C753562DE7AEB5A9E3E6C1A98E94D8DB7C31407DAC5D071E06B80B09E146F22DB85F1D72D1EA18D22600032C6DD40E3714D5ADA7DE9D7D01E88391F893156D6F4BF13E9063559DA0786DE9BDE6B1C9B0BB968EDDE07145ABF877B931682CCB1FB800728724D04AF241E2827E0FA1F62591914FF25DF0403010001DF0314D25FF86975B32EFDFF900C18A93C30D7531EC7BB");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201FCDF0803000000DF050420201231DF060101DF070100DF0281F8B3296C91F4795BD97112606903407B6EFF3AB39246E91095E51D17867DA4ADE59A48BE2FE9B52710283D3D32260E2C7D247214C57D46AA6465E47E0A4B3FFAAD8A7F6A190755BCCFE3F3FB3989A9F6B1C9E1845BCCCAD6F20B1DAC6033600234E81DAC4153212B0F760C23099192AA6C4C9083BEFFD9A79D2A27B08FECC8E5D437D6C68550A839B1294151DABA9D9CB2F160F60F749289F500C8C7F334BD20EBAC4AB109CF3C182F1B781C7C097A7903530746C449B99E39E4DB6493DD2A02E37C62AE8BC9A7470ECCCF8DC06A18C33CD24B30D56F25D2755CE82AA4DE4D2EAEC07750A03DB75EBD0D8EBC9F2A1D85A0D252EFF40329BE05DF0403010001DF031482CBE94F29929847E749231D8DD99895BBC198EE");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201FDDF0803000000DF050420201231DF060101DF070100DF028190C9485DBEB5E40415D1B397524F47685F306CFDC499D4E2E7D0CBAF222CFA8184BD111DAEEDC9CC6EC8540C3F7271EA9990119CC5C43180501D9F45252D6835053FAE35696AE8CD67A325647449CF5E594DA8F627209F7F03AE8D6DFC0DB3E79E28E415DF29A5B57D6814856CC30A96DA5B8890363E507FCB2E283DA1EBB5F18E8E24102B7D0192BB8E35A4F7CD05A435DF0403010001DF0314EE213BE58C49768729D342EF567F831FCF8ED675");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201FBDF0803000000DF050420201231DF060101DF070100DF0281909B170603A489C7546C45DA57B8FFD1DB2061240F0E8C6D1F9ABDC6B265AA8911915C1A4EABD8D0ED4755D1B902BA06FE5A645B786CD241295517D44EF1A7C25D75AFE0EB28066E4D69FEE7ABAFDD5EEB230F14E402C9840825FA77EAD12B5F1C5494701DE1897F65FE6BF106D47545EBF70CE7C158068C61F0773534DB742AB83C28038C1494F15905D0AD17CF1BD38DDF0403010001DF03146DAB76FCB2A99F0C305BB3B2483AD998ABE03741");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201FADF0803000000DF050420201231DF060101DF070100DF0281F8A4203E0C7BEB27097B63C103C19FDCDA671AEA7F813065756F3B9B81810CBD4BC4DEC548FBF1F3CDAE51F847235CBF2C8BADD8ACA7C93BEA3D44E80ED6A7B70E29622619DB420ACCCE07E1DD4E6C354F359FBDC9C5B70813926F77D827E52B19DAF09BFAE5274438BB8F61D17753C9EC0A8EFA3B7E46F02692160D2653CDBCC71B7D48BD37968316EB444F6504B9421B7DD3035A2C117D8B1F76A8975440DA9563618102397B881CEF8ADA7689EDFACE32482A2DFFED656E7F951DB841DA78368C6293BFC1053A86A845BFA6578E4B69F100B42B558FDE1AECEC6D250741BC783AA8A68A4261E7BB9246B10587A498D68DD955CE8B2B2433DF0403010001DF03147991D6A7DC5E141950B77800C0E838C636E31EA8");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000049F2201FFDF0803000000DF050420201231DF060101DF070100DF028190F69DBB5E15983EAE3CCF31CF4E47098C2FC16F97A0C710F84777EFA99622D86502B138728AB12E3481A84D20E014AD2D634D2836F27F294924B895A87F91F81B8169D4DFDAD8D7CBD741804CD61B467C7A9ACFECEB71188CAA73A907547699D45C9C7D2098AC2966266417F665A46BDD012C097DBD33D1D11AFF6EC8A9C0AD814A65B48262CA011636079A328C1AAEB7DF0403010001DF0314741767D70855E9573FD70A713D02BA015BC322F2");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000659F220102DF0803000000DF050420201231DF060101DF070100DF028180BB7F51983FD8707FD6227C23DEF5D5377A5A737CEF3C5252E578EFE136DF87B50473F9341F1640C8D258034E14C16993FCE6C6B8C3CEEB65FC8FBCD8EB77B3B05AC7C4D09E0FA1BA2EFE87D3184DB6718AE41A7CAD89B8DCE0FE80CEB523D5D647F9DB58A31D2E71AC677E67FA6E75820736C9893761EE4ACD11F31DBDC349EFDF0403010001DF03143FF581945EEF2DC065BE94A2D51E09801B3C809C");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000659F220103DF0803000000DF050420201231DF060101DF070100DF0281F8C9E6C1F3C6949A8A42A91F8D0224132B2865E6D953A5B5A54CFFB0412439D54AEBA79E9B399A6C104684DF3FB727C7F55984DB7A450E6AA917E110A7F2343A0024D2785D9EBE09F601D592362FDB237700B567BA14BBE2A6D3D23CF1270B3DD822B5496549BF884948F55A0D308348C4B723BAFB6A7F3975AC397CAD3C5D0FC2D178716F5E8E79E75BEB1C84FA202F80E68069A984E008706B30C212305456201540787925E86A8B28B129A11AF204B387CB6EE43DB53D15A46E13901BEBD5CECF4854251D9E9875B16E82AD1C5938A972842C8F1A42EBB5AE5336B04FF3DA8B8DFBE606FCA8B9084EE05BF67950BA89897CD089F924DBCDDF040103DF031443A3151513B7ADCEB92DBEA2A262CEB336D26C83");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220150DF0803000000DF050420201231DF060101DF070100DF028180D11197590057B84196C2F4D11A8F3C05408F422A35D702F90106EA5B019BB28AE607AA9CDEBCD0D81A38D48C7EBB0062D287369EC0C42124246AC30D80CD602AB7238D51084DED4698162C59D25EAC1E66255B4DB2352526EF0982C3B8AD3D1CCE85B01DB5788E75E09F44BE7361366DEF9D1E1317B05E5D0FF5290F88A0DB47DF0403010001DF0314CAF1BA5992BF70B1D47D711D180EC0A1DCEF4AD3");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220151DF0803000000DF050420201231DF060101DF070100DF028190DB5FA29D1FDA8C1634B04DCCFF148ABEE63C772035C79851D3512107586E02A917F7C7E885E7C4A7D529710A145334CE67DC412CB1597B77AA2543B98D19CF2CB80C522BDBEA0F1B113FA2C86216C8C610A2D58F29CF3355CEB1BD3EF410D1EDD1F7AE0F16897979DE28C6EF293E0A19282BD1D793F1331523FC71A228800468C01A3653D14C6B4851A5C029478E757FDF040103DF0314AC816FE9DB6AFF341B7F0E94524C2506A9867ED8");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220153DF0803000000DF050420201231DF060101DF070100DF0281F8BCD83721BE52CCCC4B6457321F22A7DC769F54EB8025913BE804D9EABBFA19B3D7C5D3CA658D768CAF57067EEC83C7E6E9F81D0586703ED9DDDADD20675D63424980B10EB364E81EB37DB40ED100344C928886FF4CCC37203EE6106D5B59D1AC102E2CD2D7AC17F4D96C398E5FD993ECB4FFDF79B17547FF9FA2AA8EEFD6CBDA124CBB17A0F8528146387135E226B005A474B9062FF264D2FF8EFA36814AA2950065B1B04C0A1AE9B2F69D4A4AA979D6CE95FEE9485ED0A03AEE9BD953E81CFD1EF6E814DFD3C2CE37AEFA38C1F9877371E91D6A5EB59FDEDF75D3325FA3CA66CDFBA0E57146CC789818FF06BE5FCC50ABD362AE4B80996DDF040103DF031445D85563596CD854BB89FAC11CBC524A0AC0A19C");
            emvOptV2.addCapk(capkV2);
            capkV2 = EmvUtil.hexStr2Rid("9F0605A0000000039F220196DF0803000000DF050420201231DF060101DF070100DF028180B74586D19A207BE6627C5B0AAFBC44A2ECF5A2942D3A26CE19C4FFAEEE920521868922E893E7838225A3947A2614796FB2C0628CE8C11E3825A56D3B1BBAEF783A5C6A81F36F8625395126FA983C5216D3166D48ACDE8A431212FF763A7F79D9EDB7FED76B485DE45BEB829A3D4730848A366D3324C3027032FF8D16A1E44D8DDF040103DF0314C63D0D8598AA7A5AA342FB80489C39A2A6E5A5F7");
            emvOptV2.addCapk(capkV2);
            LogUtil.e(Constant.TAG, "init AID and CAPKs success");
        } catch (Exception e) {
            e.printStackTrace();
            LogUtil.e(Constant.TAG, "initAIDAndRid fail");
        }
    }

    /**
     * Set EMV terminal parameters.
     * <br/> Client app should save their own terminal parameters
     */
    public static void setTerminalParam(Map<String, String> map) {
        try {
            EMVOptV2 emvOptV2 = MyApplication.mEMVOptV2;

            EmvTermParamV2 emvTermParam = new EmvTermParamV2();
            emvTermParam.countryCode = map.get("countryCode");
            emvTermParam.capability = map.get("capability");
//            emvTermParam.currencyCode = map.get("5F2A");
//            emvTermParam.currencyExp = map.get("5F36");
            int result = emvOptV2.setTerminalParam(emvTermParam);
            LogUtil.e(Constant.TAG, "setTerminalParam result:" + result);
        } catch (Exception e) {
            e.printStackTrace();
            LogUtil.e(Constant.TAG, "setTerminalParam fail");
        }
    }

    /** Convert Hex string AID to AidV2 */
    public static AidV2 hexStr2Aid(String hexStr) {
        AidV2 aidV2 = new AidV2();
        Map<String, TLV> map = TLVUtil.buildTLVMap(hexStr);
        TLV tlv = map.get("DF21");
        if (tlv != null) {
            aidV2.cvmLmt = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF20");
        if (tlv != null) {
            aidV2.termClssLmt = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF19");
        if (tlv != null) {
            aidV2.termClssOfflineFloorLmt = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F7B");
        if (tlv != null) {
            aidV2.termOfflineFloorLmt = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F06");
        if (tlv != null) {
            aidV2.aid = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF01");
        if (tlv != null) {
            aidV2.selFlag = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("DF17");
        if (tlv != null) {
            aidV2.targetPer = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("DF16");
        if (tlv != null) {
            aidV2.maxTargetPer = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("9F1B");
        if (tlv != null) {
            aidV2.floorLimit = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF15");
        if (tlv != null) {
            aidV2.threshold = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF13");
        if (tlv != null) {
            aidV2.TACDenial = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF12");
        if (tlv != null) {
            aidV2.TACOnline = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF11");
        if (tlv != null) {
            aidV2.TACDefault = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F01");
        if (tlv != null) {
            aidV2.AcquierId = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF14");
        if (tlv != null) {
            aidV2.dDOL = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F09");
        if (tlv != null) {
            aidV2.version = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F4E");
        if (tlv != null) {
            aidV2.merchName = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F15");
        if (tlv != null) {
            aidV2.merchCateCode = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F16");
        if (tlv != null) {
            aidV2.merchId = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F3C");
        if (tlv != null) {
            aidV2.referCurrCode = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F3D");
        if (tlv != null) {
            aidV2.referCurrExp = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("DFC108");
        if (tlv != null) {
            aidV2.clsStatusCheck = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("DFC109");
        if (tlv != null) {
            aidV2.zeroCheck = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("DFC10A");
        if (tlv != null) {
            aidV2.kernelType = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("DFC10B");
        if (tlv != null) {
            aidV2.paramType = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("9F66");
        if (tlv != null) {
            aidV2.ttq = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F1C");
        if (tlv != null) {
            aidV2.termId = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F1D");
        if (tlv != null) {
            aidV2.riskManData = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF8101");
        if (tlv != null) {
            aidV2.referCurrCon = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF8102");
        if (tlv != null) {
            aidV2.tDOL = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        return aidV2;
    }

    /** Convert Hex string RID to CapkV2 */
    public static CapkV2 hexStr2Rid(String hexStr) {
        CapkV2 capkV2 = new CapkV2();
        Map<String, TLV> map = TLVUtil.buildTLVMap(hexStr);
        TLV tlv = map.get("9F06");
        if (tlv != null) {
            capkV2.rid = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("9F22");
        if (tlv != null) {
            capkV2.index = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("DF06");
        if (tlv != null) {
            capkV2.hashInd = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("DF07");
        if (tlv != null) {
            capkV2.arithInd = ByteUtil.hexStr2Byte(tlv.getValue());
        }
        tlv = map.get("DF02");
        if (tlv != null) {
            capkV2.modul = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF04");
        if (tlv != null) {
            capkV2.exponent = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF05");
        if (tlv != null) {
            capkV2.expDate = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        tlv = map.get("DF03");
        if (tlv != null) {
            capkV2.checkSum = ByteUtil.hexStr2Bytes(tlv.getValue());
        }
        return capkV2;
    }


}
